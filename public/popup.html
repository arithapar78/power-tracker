<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Power Tracker</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container" data-theme="light">
    <!-- Header Card -->
    <div class="header-card">
      <div class="header-content">
        <div class="logo-section">
          <img src="icon-48.png" alt="Power Tracker Logo" class="logo" id="popupLogo">
          <div class="brand-info">
            <h1>Power Tracker</h1>
            <div class="status-indicator" id="statusIndicator">
              <span class="status-dot" id="statusDot" role="status" aria-live="polite"></span>
              <span class="status-text" id="statusText">Loading...</span>
            </div>
          </div>
        </div>
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="Switch theme">
          <span class="theme-icon">🌙</span>
        </button>
      </div>
    </div>

    <!-- Power Display Card -->
    <div class="power-display-card">
      <div class="card-header">
        <h2>Current Power Usage</h2>
        <div class="power-mode-toggle">
          <button class="toggle-button" id="frontendModeBtn" data-mode="frontend" title="Browser power only">
            Browser Only
          </button>
          <button class="toggle-button active" id="totalModeBtn" data-mode="total" title="Total power including AI">
            <span class="toggle-icon">⚡</span>
            Total Power
          </button>
        </div>
      </div>
      <div class="power-display" id="powerDisplay">
        <div class="power-value" id="powerValue">--</div>
        <div class="power-unit">Watts</div>
      </div>
      <div class="power-description" id="powerDescription">
        Calculating power consumption...
      </div>
      <div class="efficiency-indicator">
        <span class="efficiency-badge" id="efficiencyBadge">--</span>
        <span class="efficiency-label">Efficiency Rating</span>
      </div>
    </div>

    <!-- Environmental Impact Cards -->
    <div class="section-header">
      <h2>Environmental Impact</h2>
    </div>
    <div class="impact-cards-grid">
      <div class="impact-card bulbs-card" role="button" tabindex="0">
        <div class="impact-icon">💡</div>
        <div class="impact-content">
          <div class="impact-value" id="bulbsCount">--</div>
          <div class="impact-label">LED Bulbs</div>
          <div class="impact-description">powered equivalent</div>
        </div>
      </div>
      
      <div class="impact-card water-card" role="button" tabindex="0">
        <div class="impact-icon">💧</div>
        <div class="impact-content">
          <div class="impact-value" id="waterUsage">--</div>
          <div class="impact-label">Water Usage</div>
          <div class="impact-description">gallons per hour</div>
        </div>
      </div>
      
      <div class="impact-card carbon-card" role="button" tabindex="0">
        <div class="impact-icon">🌱</div>
        <div class="impact-content">
          <div class="impact-value" id="carbonEmissions">--</div>
          <div class="impact-label">Carbon Footprint</div>
          <div class="impact-description">CO₂ per hour</div>
        </div>
      </div>
    </div>

    <!-- AI Model Information Card -->
    <div class="ai-model-card" id="aiModelInfoSection">
      <div class="card-header">
        <div class="header-icon">🤖</div>
        <h2>AI Model Detected</h2>
      </div>
      <div class="ai-model-info">
        <div class="model-details">
          <div class="model-name" id="currentModelName">Claude Sonnet 4</div>
          <div class="model-version" id="currentModelVersion">Latest</div>
        </div>
        <div class="energy-metrics">
          <div class="energy-metric">
            <span class="metric-label">Session Energy</span>
            <span class="metric-value" id="sessionEnergyUsage">~2.5 Wh</span>
          </div>
          <div class="energy-metric">
            <span class="metric-label">Carbon Impact</span>
            <span class="metric-value" id="sessionCarbonUsage">~1.2g CO₂</span>
          </div>
          <div class="energy-metric">
            <span class="metric-label">Efficiency</span>
            <span class="metric-value efficiency-good" id="modelEfficiency">High</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Current Tab Information Card -->
    <div class="tab-info-card">
      <div class="card-header">
        <h2>Current Tab</h2>
      </div>
      <div class="tab-details" id="currentTabInfo">
        <div class="tab-title" id="tabTitle">Loading...</div>
        <div class="tab-url" id="tabUrl">...</div>
        <div class="tab-metrics-grid">
          <div class="tab-metric">
            <span class="metric-label">DOM Nodes</span>
            <span class="metric-value" id="domNodes">--</span>
          </div>
          <div class="tab-metric">
            <span class="metric-label">Active Time</span>
            <span class="metric-value" id="activeTime">--</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Energy Recommendations Cards -->
    <div class="recommendations-section" id="tabEnergyRecommendations" style="display: none;">
      <div class="section-header">
        <h2>💡 Energy Saving Suggestions</h2>
      </div>
      
      <!-- High Energy Tabs -->
      <div class="recommendation-card high-energy-card" id="highEnergyTabsSection" style="display: none;">
        <div class="card-header">
          <div class="header-icon">⚡</div>
          <h3>High Energy Tabs</h3>
        </div>
        <div class="recommendation-list" id="highEnergyTabsList">
          <!-- High energy tabs will be populated here -->
        </div>
      </div>

      <!-- Tab Closing Suggestions -->
      <div class="recommendation-card closing-suggestions-card" id="tabClosingSuggestions" style="display: none;">
        <div class="card-header">
          <div class="header-icon">🗂️</div>
          <h3>Suggested Tab Closures</h3>
        </div>
        <div class="suggestion-list" id="closingSuggestionsList">
          <!-- Tab closing suggestions will be populated here -->
        </div>
        <div class="card-actions">
          <button class="btn btn-primary" id="closeRecommendedBtn">Close Selected</button>
          <button class="btn btn-secondary" id="dismissSuggestionsBtn">Dismiss</button>
        </div>
      </div>

      <!-- Energy Summary Card -->
      <div class="summary-card" id="energySummarySection" style="display: none;">
        <div class="card-header">
          <div class="header-icon">📊</div>
          <h3>Energy Summary</h3>
        </div>
        <div class="summary-stats">
          <div class="summary-stat">
            <span class="stat-value" id="totalTabsCount">--</span>
            <span class="stat-label">Total Tabs</span>
          </div>
          <div class="summary-stat">
            <span class="stat-value" id="highEnergyCount">--</span>
            <span class="stat-label">High Energy</span>
          </div>
          <div class="summary-stat">
            <span class="stat-value" id="potentialSavings">--</span>
            <span class="stat-label">Potential Savings</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Today's Stats Cards -->
    <div class="section-header">
      <h2>Today's Summary</h2>
    </div>
    <div class="stats-cards-grid">
      <div class="stat-card">
        <div class="stat-value" id="totalTabs">--</div>
        <div class="stat-label">Tabs Tracked</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="avgPower">--</div>
        <div class="stat-label">Avg Power</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="highPowerAlerts">--</div>
        <div class="stat-label">High Power Alerts</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalTime">--</div>
        <div class="stat-label">Active Time</div>
      </div>
    </div>

    <!-- Power Saving Tips Card -->
    <div class="tips-card" id="tipsSection" style="display: none;">
      <div class="card-header">
        <div class="header-icon">💡</div>
        <h2>Power Saving Tip</h2>
      </div>
      <div class="tip-content">
        <div class="tip-text" id="powerTip"></div>
        <button class="btn btn-primary" id="tipAction">Apply Tip</button>
      </div>
    </div>

    <!-- Action Buttons Card -->
    <div class="actions-card">
      <div class="action-buttons">
        <button class="btn btn-primary" id="viewHistoryBtn">
          <span class="btn-icon">📊</span>
          View History
        </button>
        <button class="btn btn-secondary" id="settingsBtn">
          <span class="btn-icon">⚙️</span>
          Settings
        </button>
        <button class="btn btn-secondary" id="advancedFeaturesBtn">
          <span class="btn-icon">🚀</span>
          Advanced Features
        </button>
      </div>
    </div>

    <!-- LearnTAV Website Card -->
    <div class="learntav-card">
      <div class="card-header">
        <div class="header-icon">🎓</div>
        <h2>Discover LearnTAV</h2>
      </div>
      <div class="learntav-content">
        <p>Enhance your development skills with AI-powered learning.</p>
        <p class="learntav-description">Explore comprehensive courses, tutorials, and resources designed for modern developers.</p>
        <a href="https://learntav.com" target="_blank" class="btn btn-learntav" id="learnTavWebsiteBtn">
          <span class="btn-icon">🌐</span>
          Visit LearnTAV's Website
        </a>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading power consumption data...</div>
    </div>
  </div>

  <script src="enhanced-ai-energy-database.js"></script>
  <script src="enhanced-query-estimation.js"></script>
  <script src="ai-model-comparison.js"></script>
  <script src="ai-energy-database.js"></script>
  <script src="backend-power-calculator.js"></script>
  <script src="popup.js"></script>
</body>
</html>
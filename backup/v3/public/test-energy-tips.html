<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Tips Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .power-display {
            font-size: 24px;
            font-weight: bold;
            color: #d9534f;
            margin: 10px 0;
        }
        .tip-display {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        video {
            width: 300px;
            height: 200px;
            background: #000;
        }
        .animated-box {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            animation: rotate 2s linear infinite;
            margin: 10px;
            display: inline-block;
        }
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .results {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üîã Power Tracker - Energy Tips Test Page</h1>
    <p>This page tests the comprehensive energy-saving tips system. The Power Tracker extension should detect different usage scenarios and show contextual tips.</p>

    <div class="test-section">
        <h2>üìπ Video Streaming Simulation (High Power ~45-60W)</h2>
        <p>Simulates video streaming which typically consumes high power:</p>
        <video controls>
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <br>
        <button class="test-button" onclick="playVideo()">‚ñ∂Ô∏è Play Video</button>
        <button class="test-button" onclick="pauseVideo()">‚è∏Ô∏è Pause Video</button>
        <div class="power-display">Expected: 45-60W - Should trigger video streaming tips</div>
    </div>

    <div class="test-section">
        <h2>üéÆ Gaming/Animation Simulation (High Power ~40-50W)</h2>
        <p>Simulates CPU-intensive content with animations:</p>
        <div class="animated-box"></div>
        <div class="animated-box"></div>
        <div class="animated-box"></div>
        <div class="animated-box"></div>
        <canvas id="gameCanvas" width="400" height="200" style="border: 1px solid #000; background: #222;"></canvas>
        <br>
        <button class="test-button" onclick="startAnimation()">üé® Start Animations</button>
        <button class="test-button" onclick="stopAnimation()">üõë Stop Animations</button>
        <div class="power-display">Expected: 40-50W - Should trigger gaming/animation tips</div>
    </div>

    <div class="test-section">
        <h2>üì± Social Media Simulation (Moderate Power ~30-40W)</h2>
        <p>Simulates social media with auto-playing content (navigate to facebook.com, twitter.com, etc. for real test):</p>
        <div id="socialFeed">
            <div style="border: 1px solid #ccc; margin: 10px; padding: 15px; border-radius: 8px;">
                <strong>Social Post 1</strong><br>
                <video width="250" height="150" autoplay muted loop>
                    <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
                </video>
                <p>This is a sample social media post with auto-playing video content...</p>
            </div>
        </div>
        <div class="power-display">Expected: 30-40W - Should trigger social media tips</div>
    </div>

    <div class="test-section">
        <h2>üíº Productivity Simulation (Low-Moderate Power ~20-30W)</h2>
        <p>Simulates productivity work (navigate to docs.google.com, office.com, etc. for real test):</p>
        <textarea style="width: 100%; height: 100px;" placeholder="This simulates document editing..."></textarea>
        <div style="display: flex; gap: 10px; margin: 10px 0;">
            <div style="flex: 1; border: 1px solid #ccc; padding: 10px;">Tab 1: Document</div>
            <div style="flex: 1; border: 1px solid #ccc; padding: 10px;">Tab 2: Spreadsheet</div>
            <div style="flex: 1; border: 1px solid #ccc; padding: 10px;">Tab 3: Presentation</div>
        </div>
        <div class="power-display">Expected: 20-30W - Should trigger productivity tips</div>
    </div>

    <div class="test-section">
        <h2>üå± Efficient Browsing (Low Power ~10-20W)</h2>
        <p>Simulates efficient browsing - simple text content:</p>
        <div style="line-height: 1.6;">
            <h3>Energy-Efficient Article</h3>
            <p>This is simple text content that uses minimal power. Reading articles like this is very energy-efficient compared to video streaming or interactive content.</p>
            <p>When browsing efficiently, you should see achievement notifications congratulating you on your eco-friendly browsing habits!</p>
        </div>
        <div class="power-display" style="color: #28a745;">Expected: 10-20W - Should trigger achievement tips! üéâ</div>
    </div>

    <div class="test-section">
        <h2>üß™ Tips Testing Controls</h2>
        <p>Use these buttons to manually test the tips system:</p>
        <button class="test-button" onclick="testTipsDatabase()">üîç Test Tips Database</button>
        <button class="test-button" onclick="simulateHighPower()">‚ö° Simulate High Power Tip</button>
        <button class="test-button" onclick="simulateModeratePower()">üìä Simulate Moderate Power Tip</button>
        <button class="test-button" onclick="simulateAchievement()">üèÜ Simulate Achievement Tip</button>
        <button class="test-button" onclick="clearAllTips()">üßπ Clear All Tips</button>
        
        <div id="testResults" class="results" style="display: none;">
            <h4>Test Results:</h4>
            <div id="resultsContent"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üìã Expected Behavior</h2>
        <ul>
            <li><strong>Video Section:</strong> Should show "High Video Power Usage" tip when video is playing</li>
            <li><strong>Gaming Section:</strong> Should show "Animation Power Usage" or "Gaming Power Alert" tips</li>
            <li><strong>Social Media:</strong> Should show "Social Media Power Usage" tips</li>
            <li><strong>Productivity:</strong> Should show "Too Many Productivity Tabs" or efficiency tips</li>
            <li><strong>Efficient Browsing:</strong> Should show "Efficient Browsing! üå±" achievement tips</li>
            <li><strong>All Sections:</strong> Tips should appear in bottom-right corner with appropriate icons and actions</li>
        </ul>
        
        <h3>üîß Tip Actions to Test:</h3>
        <ul>
            <li>Pause Media - Should pause all video/audio elements</li>
            <li>Reduce Animations - Should disable CSS animations</li>
            <li>Refresh Page - Should reload the current page</li>
            <li>Close Tab - Should close the current tab</li>
            <li>Optimize Tab - Should apply multiple optimizations</li>
            <li>Toggle Dark Mode - Should attempt to enable dark mode</li>
        </ul>
    </div>

    <script>
        // Test video controls
        function playVideo() {
            const video = document.querySelector('video');
            if (video) video.play();
        }
        
        function pauseVideo() {
            const videos = document.querySelectorAll('video');
            videos.forEach(v => v.pause());
        }
        
        // Animation controls
        let animationInterval;
        function startAnimation() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            let x = 0;
            
            animationInterval = setInterval(() => {
                ctx.clearRect(0, 0, 400, 200);
                ctx.fillStyle = '#ff6b6b';
                ctx.fillRect(x, 50, 50, 50);
                ctx.fillStyle = '#4ecdc4';
                ctx.fillRect(x + 60, 100, 50, 50);
                x = (x + 5) % 350;
            }, 50);
        }
        
        function stopAnimation() {
            if (animationInterval) {
                clearInterval(animationInterval);
                const canvas = document.getElementById('gameCanvas');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, 400, 200);
            }
        }
        
        // Tips testing functions
        function testTipsDatabase() {
            if (typeof EnergySavingTipsDatabase !== 'undefined') {
                const tipsDb = new EnergySavingTipsDatabase();
                const testTip = tipsDb.getContextualTip(45, {
                    url: 'https://youtube.com/watch?v=test',
                    title: 'Test Video',
                    lastMetrics: { cpuIntensiveElements: { videos: 1 } }
                });
                
                showResults('Tips Database Test', testTip ? 
                    `‚úÖ Success! Generated tip: "${testTip.title}" - ${testTip.message}` :
                    '‚ùå Failed to generate tip');
            } else {
                showResults('Tips Database Test', '‚ùå EnergySavingTipsDatabase not available');
            }
        }
        
        function simulateHighPower() {
            if (window.energyNotificationManager) {
                window.energyNotificationManager.showTip({
                    type: 'high_power_video',
                    severity: 'urgent',
                    title: 'High Video Power Usage',
                    message: 'Video streaming is using 52W. Consider lowering quality to save energy.',
                    powerWatts: 52,
                    actionText: 'Pause Media',
                    action: 'pause_media',
                    duration: 8000,
                    icon: 'üìπ'
                });
                showResults('High Power Simulation', '‚úÖ High power tip displayed!');
            } else {
                showResults('High Power Simulation', '‚ùå Notification manager not available');
            }
        }
        
        function simulateModeratePower() {
            if (window.energyNotificationManager) {
                window.energyNotificationManager.showTip({
                    type: 'moderate_power_social',
                    severity: 'warning',
                    title: 'Social Media Power Usage',
                    message: 'Auto-playing content is using 38W. Consider pausing videos.',
                    powerWatts: 38,
                    actionText: 'Pause Media',
                    action: 'pause_media',
                    duration: 6000,
                    icon: 'üì±'
                });
                showResults('Moderate Power Simulation', '‚úÖ Moderate power tip displayed!');
            } else {
                showResults('Moderate Power Simulation', '‚ùå Notification manager not available');
            }
        }
        
        function simulateAchievement() {
            if (window.energyNotificationManager) {
                window.energyNotificationManager.showTip({
                    type: 'achievement_efficient',
                    severity: 'success',
                    title: 'Efficient Browsing! üå±',
                    message: 'Excellent! Only 12W usage. You\'re saving the planet one tab at a time.',
                    powerWatts: 12,
                    actionText: 'Keep It Up!',
                    action: null,
                    duration: 5000,
                    icon: 'üå±'
                });
                showResults('Achievement Simulation', '‚úÖ Achievement tip displayed!');
            } else {
                showResults('Achievement Simulation', '‚ùå Notification manager not available');
            }
        }
        
        function clearAllTips() {
            if (window.energyNotificationManager && window.energyNotificationManager.hideAllTips) {
                window.energyNotificationManager.hideAllTips();
                showResults('Clear Tips', '‚úÖ All tips cleared!');
            } else {
                // Fallback - remove any visible tips
                const tips = document.querySelectorAll('.energy-tip-notification');
                tips.forEach(tip => tip.remove());
                showResults('Clear Tips', '‚úÖ Tips cleared (fallback method)');
            }
        }
        
        function showResults(testName, result) {
            const resultsDiv = document.getElementById('testResults');
            const contentDiv = document.getElementById('resultsContent');
            
            resultsDiv.style.display = 'block';
            contentDiv.innerHTML += `<div><strong>${testName}:</strong> ${result}</div>`;
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                if (resultsDiv.style.display !== 'none') {
                    resultsDiv.style.display = 'none';
                    contentDiv.innerHTML = '';
                }
            }, 10000);
        }
        
        // Auto-start some content for testing
        window.addEventListener('load', () => {
            // Start one animation by default
            setTimeout(startAnimation, 1000);
            
            // Show test info
            console.log('üîã Power Tracker Energy Tips Test Page Loaded');
            console.log('üìä This page should trigger various energy-saving tips based on simulated power usage');
            console.log('üéØ Expected tips: Video streaming, Gaming/Animation, Social media, Productivity, and Achievement tips');
        });
    </script>
</body>
</html>